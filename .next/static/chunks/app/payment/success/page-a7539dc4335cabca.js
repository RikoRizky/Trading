(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[478],{9071:function(e,r,t){Promise.resolve().then(t.bind(t,7944))},7944:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var s=t(7437),n=t(2265),i=t(4033),a=t(1122);function o(){let e=(0,i.useRouter)(),r=(0,i.useSearchParams)(),{user:t,profile:o,refreshProfile:l}=(0,a.useAuth)(),[c,u]=(0,n.useState)(!0),[d,h]=(0,n.useState)("success");(0,n.useEffect)(()=>{let e=r.get("order_id");if(r.get("transaction_status"),!e){h("error"),u(!1);return}g(e)},[r]);let g=async e=>{try{let r=await fetch("/api/payment/status/".concat(e)),t=await r.json();t.success?"paid"===t.status?(h("success"),await l()):"pending"===t.status?h("pending"):h("error"):h("error")}catch(e){console.error("Error checking payment status:",e),h("error")}finally{u(!1)}};return c?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Verifying payment..."})]})}):"success"===d?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Your premium subscription has been activated. You now have access to all premium features."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition",children:"Go to Dashboard"}),(0,s.jsx)("button",{onClick:()=>e.push("/videos"),className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition",children:"Browse Premium Videos"})]})]})}):"pending"===d?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Pending"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Your payment is being processed. You will receive an email confirmation once it's completed."}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition",children:"Go to Dashboard"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Failed"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"There was an issue processing your payment. Please try again or contact support."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>e.push("/upgrade"),className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition",children:"Try Again"}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition",children:"Go to Dashboard"})]})]})})}},1122:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return o},useAuth:function(){return l}});var s=t(7437),n=t(2265),i=t(1097);let a=(0,n.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,n.useState)(null),[l,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(!0),h=(0,i.e)();(0,n.useEffect)(()=>{let e=async e=>{try{let{data:r,error:t}=await h.from("profiles").select("*").eq("id",e).single();t?console.error("Error fetching profile:",t):c(r)}catch(e){console.error("Error in fetchProfile:",e)}};(async()=>{try{let{data:{session:r},error:t}=await h.auth.getSession();t?console.error("Error getting session:",t):(null==r?void 0:r.user)&&(o(r.user),await e(r.user.id))}catch(e){console.error("Error in getInitialSession:",e)}finally{d(!1)}})();let{data:{subscription:r}}=h.auth.onAuthStateChange(async(r,t)=>{"SIGNED_IN"===r&&(null==t?void 0:t.user)?(o(t.user),await e(t.user.id)):"SIGNED_OUT"===r&&(o(null),c(null)),d(!1)});return()=>{r.unsubscribe()}},[h.auth]);let g=async()=>{try{let{error:e}=await h.auth.signOut();e&&console.error("Error signing out:",e)}catch(e){console.error("Error in signOut:",e)}},m=async()=>{if(t)try{let{data:e,error:r}=await h.from("profiles").select("*").eq("id",t.id).single();r?console.error("Error refreshing profile:",r):c(e)}catch(e){console.error("Error in refreshProfile:",e)}};return(0,s.jsx)(a.Provider,{value:{user:t,profile:l,loading:u,signOut:g,refreshProfile:m},children:r})}function l(){let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1097:function(e,r,t){"use strict";t.d(r,{e:function(){return n}});var s=t(3082);let n=()=>(0,s.createClientComponentClient)()},4033:function(e,r,t){e.exports=t(5313)}},function(e){e.O(0,[872,82,971,938,744],function(){return e(e.s=9071)}),_N_E=e.O()}]);