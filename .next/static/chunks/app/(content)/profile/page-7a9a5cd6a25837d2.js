(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[832],{2330:function(e,t,a){Promise.resolve().then(a.bind(a,2594))},2594:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var r=a(7437),n=a(1122),l=a(2265),s=a(1097);let i=l.forwardRef(function({title:e,titleId:t,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?l.createElement("title",{id:t},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))});var o=a(1809),c=a(7805),u=a(6689),d=a(2125);let m=l.forwardRef(function({title:e,titleId:t,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?l.createElement("title",{id:t},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))});var f=a(8793);function h(){let{user:e}=(0,n.useAuth)(),t=(0,s.e)(),[a,h]=(0,l.useState)(null),[x,b]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),[w,v]=(0,l.useState)(!1),[y,j]=(0,l.useState)(""),[k,N]=(0,l.useState)(""),[E,_]=(0,l.useState)(""),[C,S]=(0,l.useState)(null),[Z,L]=(0,l.useState)(!1),[B,P]=(0,l.useState)("");(0,l.useEffect)(()=>{a&&j(a.full_name||"")},[a]),(0,l.useEffect)(()=>{e&&(async()=>{let{data:a,error:r}=await t.from("profiles").select("full_name, avatar_url, profile_photo, membership_type").eq("id",e.id).single();r||h(a)})()},[e,t]);let U=async()=>{if(!y.trim()){P("Nama tidak boleh kosong");return}L(!0),P("");let{error:e}=await (0,f.ck)({full_name:y.trim()});e?P("Gagal mengupdate nama: "+e.message):(P("Nama berhasil diupdate!"),h({...a,full_name:y.trim()}),b(!1)),L(!1)},K=async()=>{if(!C){P("Pilih file gambar terlebih dahulu");return}L(!0),P("");try{let r=C.name.split(".").pop(),n="".concat(e.id,"_").concat(Date.now(),".").concat(r),{data:l,error:s}=await t.storage.from("avatars").upload(n,C);if(s)throw s;let{data:{publicUrl:i}}=t.storage.from("avatars").getPublicUrl(n),{error:o}=await (0,f.ck)({avatar_url:i});if(o)throw o;P("Foto profil berhasil diupdate!"),h({...a,avatar_url:i}),g(!1),S(null)}catch(e){P("Gagal mengupload foto: "+e.message)}L(!1)},M=async()=>{if(!k){P("Kata sandi baru tidak boleh kosong");return}if(k!==E){P("Konfirmasi kata sandi tidak cocok");return}if(k.length<6){P("Kata sandi minimal 6 karakter");return}L(!0),P("");let{error:e}=await (0,f.gQ)(k);e?P("Gagal mengupdate kata sandi: "+e.message):(P("Kata sandi berhasil diupdate!"),v(!1),N(""),_("")),L(!1)};return e?(0,r.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-6 py-10",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"My Profile"}),B&&(0,r.jsx)("div",{className:"mb-6 p-4 rounded-md ".concat(B.includes("berhasil")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:B}),(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-lg p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Foto Profil"}),(0,r.jsxs)("button",{onClick:()=>g(!p),className:"flex items-center badge badge-warning space-x-2 text-blue-600 hover:text-blue-800",children:[(0,r.jsx)(i,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:p?"Batal":"Ubah"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-6",children:[(null==a?void 0:a.avatar_url)?(0,r.jsx)("img",{src:a.avatar_url,alt:a.full_name||"User",className:"w-24 h-24 rounded-full border shadow"}):(0,r.jsx)(o.Z,{className:"h-24 w-24 text-primary-600"}),p&&(0,r.jsxs)("div",{className:"flex-1 max-w-md",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return S((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,r.jsxs)("button",{onClick:K,disabled:Z,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:Z?"Menyimpan...":"Simpan"})]}),(0,r.jsxs)("button",{onClick:()=>{g(!1),S(null)},className:"flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Batal"})]})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-lg p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Informasi Profil"}),(0,r.jsxs)("button",{onClick:()=>b(!x),className:"flex items-center badge badge-warning space-x-2 text-blue-600 hover:text-blue-800",children:[(0,r.jsx)(d.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:x?"Batal":"Ubah"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Nama Lengkap"}),x?(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),className:"flex-1 px-3 py-2 border bg-black bg-opacity-50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Masukkan nama lengkap"}),(0,r.jsxs)("button",{onClick:U,disabled:Z,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:Z?"Menyimpan...":"Simpan"})]}),(0,r.jsxs)("button",{onClick:()=>{b(!1),j((null==a?void 0:a.full_name)||"")},className:"flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Batal"})]})]}):(0,r.jsx)("p",{className:"text-lg",children:(null==a?void 0:a.full_name)||"Belum diatur"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),(0,r.jsx)("p",{className:"text-lg",children:e.email})]}),(null==a?void 0:a.membership_type)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status Keanggotaan"}),"premium"===a.membership_type?(0,r.jsx)("span",{className:"inline-block px-4 py-1.5 text-sm font-medium rounded-full bg-yellow-100 text-yellow-800",children:"⭐ PREMIUM"}):(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{className:"inline-block px-4 py-1.5 text-sm font-medium rounded-full bg-gray-100 text-gray-800",children:"FREE"}),(0,r.jsxs)("button",{onClick:()=>window.open("/upgrade","_blank"),className:"inline-block px-6 py-2 text-sm font-medium rounded-full bg-gradient-to-r from-yellow-400 to-yellow-600 text-white hover:from-yellow-500 hover:to-yellow-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,r.jsx)("span",{className:"mr-2",children:"⭐"})," Upgrade to Premium"]})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Keamanan"}),(0,r.jsxs)("button",{onClick:()=>v(!w),className:"flex items-center space-x-2 badge badge-warning text-blue-600 hover:text-blue-800",children:[(0,r.jsx)(m,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:w?"Batal":"Ubah Kata Sandi"})]})]}),w&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Kata Sandi Baru"}),(0,r.jsx)("input",{type:"password",value:k,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border bg-black bg-opacity-50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Masukkan kata sandi baru"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Konfirmasi Kata Sandi"}),(0,r.jsx)("input",{type:"password",value:E,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border bg-black bg-opacity-50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Konfirmasi kata sandi baru"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:M,disabled:Z,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:Z?"Mengupdate...":"Update Kata Sandi"})]}),(0,r.jsxs)("button",{onClick:()=>{v(!1),N(""),_("")},className:"flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Batal"})]})]})]})]})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-[80vh]"})}},1122:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return i},useAuth:function(){return o}});var r=a(7437),n=a(2265),l=a(1097);let s=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(!0),m=(0,l.e)();(0,n.useEffect)(()=>{let e=async e=>{try{let{data:t,error:a}=await m.from("profiles").select("*").eq("id",e).single();a?console.error("Error fetching profile:",a):c(t)}catch(e){console.error("Error in fetchProfile:",e)}};(async()=>{try{let{data:{session:t},error:a}=await m.auth.getSession();a?console.error("Error getting session:",a):(null==t?void 0:t.user)&&(i(t.user),await e(t.user.id))}catch(e){console.error("Error in getInitialSession:",e)}finally{d(!1)}})();let{data:{subscription:t}}=m.auth.onAuthStateChange(async(t,a)=>{"SIGNED_IN"===t&&(null==a?void 0:a.user)?(i(a.user),await e(a.user.id)):"SIGNED_OUT"===t&&(i(null),c(null)),d(!1)});return()=>{t.unsubscribe()}},[m.auth]);let f=async()=>{try{let{error:e}=await m.auth.signOut();e&&console.error("Error signing out:",e)}catch(e){console.error("Error in signOut:",e)}},h=async()=>{if(a)try{let{data:e,error:t}=await m.from("profiles").select("*").eq("id",a.id).single();t?console.error("Error refreshing profile:",t):c(e)}catch(e){console.error("Error in refreshProfile:",e)}};return(0,r.jsx)(s.Provider,{value:{user:a,profile:o,loading:u,signOut:f,refreshProfile:h},children:t})}function o(){let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8793:function(e,t,a){"use strict";a.d(t,{GJ:function(){return m},Kq:function(){return f},c0:function(){return d},ck:function(){return c},gQ:function(){return u},kv:function(){return h},qj:function(){return i},w7:function(){return o},y1:function(){return l},zB:function(){return s}});var r=a(1097);async function n(){let e=(0,r.e)();try{let{data:t,error:a}=await e.auth.getUser(),r=null==t?void 0:t.user;if(a||!r)return{user:null,profile:null};let{data:n,error:l}=await e.from("profiles").select("*").eq("id",r.id).single();if(l)return console.error("Failed to fetch profile:",l),{user:r,profile:null};return{user:r,profile:n}}catch(e){return console.error("getCurrentUser() failed:",e),{user:null,profile:null}}}async function l(e,t,a){let n=(0,r.e)();return await n.auth.signUp({email:e,password:t,options:{data:{full_name:a},emailRedirectTo:"".concat(location.origin,"/auth/callback")}})}async function s(e,t){let a=(0,r.e)(),{data:n,error:l}=await a.auth.signInWithPassword({email:e,password:t});if(l)throw l;if(n.user&&null===n.user.email_confirmed_at)throw Error("Email belum diverifikasi. Silakan cek inbox.");return n}async function i(){let e=(0,r.e)();return await e.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}})}async function o(){let e=(0,r.e)();return await e.auth.signOut()}async function c(e){let t=(0,r.e)(),{data:a,error:n}=await t.auth.getUser(),l=null==a?void 0:a.user;return n||!l?{error:n||Error("No authenticated user")}:await t.from("profiles").update(e).eq("id",l.id).select().single()}async function u(e){let t=(0,r.e)();return await t.auth.updateUser({password:e})}async function d(e){let t=(0,r.e)();return await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")})}async function m(){let{profile:e}=await n();return!!(null==e?void 0:e.is_admin)}async function f(e){let t=(0,r.e)();return await t.from("profiles").update({is_admin:!0}).eq("id",e)}async function h(e){let t=(0,r.e)();return await t.from("profiles").update({is_admin:!1}).eq("id",e)}},1097:function(e,t,a){"use strict";a.d(t,{e:function(){return n}});var r=a(3082);let n=()=>(0,r.createClientComponentClient)()},7805:function(e,t,a){"use strict";var r=a(2265);let n=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))});t.Z=n},2125:function(e,t,a){"use strict";var r=a(2265);let n=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))});t.Z=n},1809:function(e,t,a){"use strict";var r=a(2265);let n=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))});t.Z=n},6689:function(e,t,a){"use strict";var r=a(2265);let n=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))});t.Z=n}},function(e){e.O(0,[653,82,971,938,744],function(){return e(e.s=2330)}),_N_E=e.O()}]);