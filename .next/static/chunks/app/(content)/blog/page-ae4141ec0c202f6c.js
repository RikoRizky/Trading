(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{3856:function(e,t,a){Promise.resolve().then(a.bind(a,8403))},8403:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7437),l=a(2265),r=a(1396),i=a.n(r),n=a(1097),o=a(2169),c=a(1122),d=a(576),u=a(5375),m=a(4020),h=a(8034),g=a(1809),x=a(2929);function v(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[v,p]=(0,l.useState)(""),[b,f]=(0,l.useState)("all"),[j,y]=(0,l.useState)([]),[N,w]=(0,l.useState)(!1),[S,k]=(0,l.useState)(!1),[C,E]=(0,l.useState)(!1),[U,P]=(0,l.useState)(!1),[_,A]=(0,l.useState)(""),[D,L]=(0,l.useState)(null),[V,I]=(0,l.useState)(""),[M,T]=(0,l.useState)("trading-basics"),[Z,q]=(0,l.useState)(null),[O,F]=(0,l.useState)(void 0),[R,G]=(0,l.useState)(!1),[B,W]=(0,l.useState)(!1),[z,H]=(0,l.useState)(!1),{profile:J}=(0,c.useAuth)(),K=[{value:"all",label:"All Articles",count:0},{value:"trading-basics",label:"Trading Basics",count:0},{value:"technical-analysis",label:"Technical Analysis",count:0},{value:"fundamental-analysis",label:"Fundamental Analysis",count:0},{value:"risk-management",label:"Risk Management",count:0},{value:"psychology",label:"Trading Psychology",count:0},{value:"strategies",label:"Trading Strategies",count:0},{value:"tools",label:"Trading Tools",count:0}];(0,l.useEffect)(()=>{try{let e=document.cookie.split(";").map(e=>e.trim()).some(e=>e.startsWith("recovery="));P(e)}catch(e){}X(),Q()},[]),(0,l.useEffect)(()=>{Y()},[e,v,b]);let Q=async()=>{try{if(U){w(!1),k(!1),E(!1);return}let e=(0,n.e)(),{data:t}=await e.auth.getUser();if(t.user){E(!0);let{data:a}=await e.from("profiles").select("is_admin, membership_type").eq("id",t.user.id).single();w((null==a?void 0:a.is_admin)||!1),k((null==a?void 0:a.membership_type)==="premium")}else E(!1),w(!1),k(!1)}catch(e){console.error("Error checking user status:",e)}},X=async()=>{try{let e=(0,n.e)(),{data:a,error:s}=await e.from("posts").select("\n          *,\n          author:profiles(*)\n        ").eq("type","article").eq("status","published").order("published_at",{ascending:!1});s?(console.error("Error fetching posts:",s),t([])):t(a||[])}catch(e){console.error("Error in fetchPosts:",e),t([])}finally{r(!1)}},Y=()=>{let e=en;v&&(e=e.filter(e=>{var t;return e.title.toLowerCase().includes(v.toLowerCase())||(null===(t=e.excerpt)||void 0===t?void 0:t.toLowerCase().includes(v.toLowerCase()))||e.content.toLowerCase().includes(v.toLowerCase())})),"all"!==b&&(e=e.filter(e=>{var t;return null===(t=e.tags)||void 0===t?void 0:t.includes(b)})),y(e)},$=e=>"all"===e?en.length:en.filter(t=>{var a;return null===(a=t.tags)||void 0===a?void 0:a.includes(e)}).length,ee=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),et=e=>["video",e],ea=async()=>{if(N&&_&&D){H(!0);try{var e;console.log("=== Starting premium video upload ==="),console.log("Form data:",{premiumVideoTitle:_,premiumVideoFile:D,premiumVideoDescription:V,premiumVideoCategory:M});let t=(0,n.e)();console.log("Supabase client created");let{data:a,error:s}=await t.auth.getUser();if(console.log("User response:",{userResp:a,userError:s}),s)throw Error("Auth error: "+s.message);let l=null===(e=a.user)||void 0===e?void 0:e.id;if(!l)throw Error("Not authenticated - no user ID");console.log("User ID:",l);let r=D.name.split(".").pop(),i="".concat(l,"-").concat(Date.now(),".").concat(r);console.log("Uploading file:",i);let{data:o,error:c}=await t.storage.from("videos").upload(i,D);if(c)throw Error("Upload error: ".concat(c.message));console.log("File uploaded successfully:",o);let{data:d}=t.storage.from("videos").getPublicUrl(i),u=d.publicUrl;console.log("Video URL:",u);let m="".concat(ee(_),"-").concat(Math.random().toString(36).slice(2,8)),h=et(M),g={title:_,slug:m,content:"",excerpt:V,type:"article",status:"published",is_premium:!0,author_id:l,tags:h,metadata:{video_url:u,video_type:"file"},published_at:new Date().toISOString()};console.log("Inserting premium video data:",g);let{data:x,error:v}=await t.from("posts").insert(g).select().single();if(v)throw Error("Database error: ".concat(v.message));if(!x)throw Error("No data returned from insert");console.log("Premium video uploaded successfully:",x),A(""),L(null),I(""),T("trading-basics"),console.log("Refreshing posts..."),await X(),alert("Video premium berhasil ditambahkan!")}catch(t){console.error("Add premium video failed:",t);let e=t instanceof Error?t.message:"Unknown error";alert("Gagal menambahkan video premium: "+e)}finally{H(!1)}}},es=e=>{var t;q(e),F("premium"),A(e.title),I(e.excerpt||""),T((null===(t=e.tags)||void 0===t?void 0:t.find(e=>"video"!==e))||"trading-basics"),G(!0)},el=async e=>{if(N&&confirm("Are you sure you want to delete this video?"))try{let t=(0,n.e)(),{error:a}=await t.from("posts").delete().eq("id",e);if(a)throw Error("Database error: ".concat(a.message));alert("Video deleted successfully!"),await X()}catch(t){console.error("Delete video failed:",t);let e=t instanceof Error?t.message:"Unknown error";alert("Failed to delete video: "+e)}},er=async()=>{if(N&&Z){H(!0);try{var e;let t=(0,n.e)(),{data:a,error:s}=await t.auth.getUser();if(s)throw Error("Auth error: "+s.message);if(!(null===(e=a.user)||void 0===e?void 0:e.id))throw Error("Not authenticated");let l={title:_,excerpt:V,tags:et(M),updated_at:new Date().toISOString()},{error:r}=await t.from("posts").update(l).eq("id",Z.id);if(r)throw Error("Database error: ".concat(r.message));alert("Video berhasil diperbarui!"),q(null),F(void 0),G(!1),A(""),L(null),I(""),T("trading-basics"),await X()}catch(t){console.error("Update video failed:",t);let e=t instanceof Error?t.message:"Unknown error";alert("Gagal memperbarui video: "+e)}finally{H(!1)}}},ei=()=>{q(null),F(void 0),G(!1),A(""),L(null),I(""),T("trading-basics")},en=e.filter(e=>{var t;return e.is_premium&&(null===(t=e.metadata)||void 0===t?void 0:t.video_url)});return a?(0,s.jsx)("div",{className:"min-h-screen pb-12 bg-gradient-to-r from-indigoSteel-dark via-indigoSteel-light to-indigoSteel-dark overflow-x-hidden",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(6)].map((e,t)=>(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("div",{className:"h-48 bg-gray-200 rounded mb-4"}),(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},t))})]})})}):(0,s.jsxs)("div",{className:"min-h-screen py-12 bg-gradient-to-r from-indigoSteel-dark via-indigoSteel-light to-indigoSteel-dark overflow-x-hidden",children:[(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"mb-12",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)(u.Z,{className:"h-8 w-8 text-primary-600 mr-3"}),(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Trading Blog"}),(0,s.jsx)("span",{className:"ml-4 badge badge-warning",children:"Premium Content"})]}),(0,s.jsxs)("p",{className:"text-xl text-gray-300 max-w-3xl",children:["Premium trading content and exclusive video tutorials.",(0,s.jsxs)("span",{className:"text-yellow-600 font-medium",children:[" ","Upgrade to premium to access all content!"]})]})]}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search premium content...",value:v,onChange:e=>p(e.target.value),className:"input pl-10"})]})}),(0,s.jsx)("div",{className:"lg:w-48",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,s.jsx)("select",{value:b,onChange:e=>f(e.target.value),className:"input pl-10 appearance-none",children:K.map(e=>(0,s.jsxs)("option",{className:"bg-black bg-opacity-80",value:e.value,children:[e.label," (",$(e.value),")"]},e.value))})]})})]})}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("p",{className:"text-gray-300",children:["Showing ",j.length," of ",en.length," premium videos"]})}),N&&(0,s.jsxs)("div",{className:"card p-6 mb-8",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add Premium Video (Admin Only)"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"md:col-span-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Title"}),(0,s.jsx)("input",{type:"text",className:"input",value:_,onChange:e=>A(e.target.value),placeholder:"Video title"})]}),(0,s.jsxs)("div",{className:"md:col-span-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Video File"}),(0,s.jsx)("input",{type:"file",accept:"video/*",className:"input",onChange:e=>{var t;return L((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},disabled:null!==Z&&"premium"===O}),(0,s.jsx)("p",{className:"text-xs text-gray-300 mt-1",children:Z&&"premium"===O?"File cannot be changed while editing":"Upload a video file (MP4, AVI, MOV, etc.)"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Description"}),(0,s.jsx)("textarea",{className:"input",rows:3,value:V,onChange:e=>I(e.target.value),placeholder:"Short description about this video..."})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Category"}),(0,s.jsx)("select",{className:"input",value:M,onChange:e=>T(e.target.value),children:K.slice(1).map(e=>(0,s.jsx)("option",{className:"bg-black bg-opacity-80",value:e.value,children:e.label},e.value))})]})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{className:"btn btn-primary",onClick:ea,disabled:z,children:z?"Saving...":"Add Premium Video"})}),(0,s.jsx)("p",{className:"text-xs text-gray-300 mt-2",children:"Premium videos are visible only to premium users."})]}),en.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:(j.length>0?B?j:j.slice(0,6):[]).map(e=>{var t,a;let l=null===(t=e.metadata)||void 0===t?void 0:t.video_url;return(0,s.jsxs)("article",{className:"card overflow-hidden hover:shadow-lg transition-shadow relative",children:[(0,s.jsx)("div",{className:"aspect-video bg-gray-200 relative",children:S?(0,s.jsx)("video",{src:l,className:"w-full h-full object-cover",controls:!0}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("video",{src:l,className:"w-full h-full object-cover filter blur-sm",muted:!0,loop:!0,style:{filter:"blur(8px)"}}),(0,s.jsx)(i(),{href:"/upgrade",className:"absolute inset-0",children:(0,s.jsx)(d.Z,{isAuthenticated:!0,isPremiumUser:!1,title:"Premium Content",description:"Upgrade to Premium to watch this video",buttonText:"Upgrade Now",buttonHref:"/upgrade"})})]})}),(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("span",{className:"bg-yellow-500 text-white text-xs px-2 py-1 rounded-full mr-2",children:"PREMIUM"}),(0,s.jsx)("span",{className:"text-xs text-gray-300",children:S?"Premium content":"Upgrade required"})]}),(0,s.jsx)(i(),{href:S?"/videos/".concat(e.slug):"/upgrade",className:"block",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1 hover:text-primary-700",children:e.title})}),e.excerpt?(0,s.jsx)("p",{className:"text-sm text-gray-300 line-clamp-2",children:e.excerpt}):null,(0,s.jsxs)("div",{className:"mt-2 flex items-center text-xs text-gray-900",children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),(null===(a=e.author)||void 0===a?void 0:a.full_name)||"Admin",(0,s.jsx)(x.Z,{className:"h-3 w-3 ml-3 mr-1"}),(0,o.p6)(e.published_at||e.created_at)]}),e.tags&&e.tags.length>0&&(0,s.jsx)("div",{className:"mt-3 flex flex-wrap gap-1",children:e.tags.slice(0,3).map(e=>(0,s.jsx)("span",{className:"text-xs badge badge-warning text-yellow-900 px-2 py-1 rounded",children:e.replace("-"," ")},e))}),N&&(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>es(e),className:"btn btn-outline btn-sm",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>el(e.id),className:"btn btn-outline btn-sm text-red-600 hover:bg-red-50",children:"Delete"})]})]})]},"premium-video-".concat(e.id))})}),0===j.length&&(0,s.jsx)("div",{className:"text-center text-gray-300 mt-4",children:"No results match your filters."}),j.length>6&&(0,s.jsx)("div",{className:"text-center mt-8",children:(0,s.jsx)("button",{onClick:()=>{W(!B)},className:"btn btn-outline",children:B?"Show Less":"See All (".concat(j.length," videos)")})})]}):(0,s.jsx)("div",{className:"py-12",children:S?(0,s.jsx)("div",{className:"text-center text-gray-300",children:"No premium videos yet."}):(0,s.jsx)(i(),{href:"/upgrade",className:"block max-w-3xl mx-auto rounded-lg overflow-hidden shadow hover:shadow-lg transition-shadow",children:(0,s.jsxs)("div",{className:"relative bg-gradient-to-r from-gray-800 to-gray-700 text-white p-10 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-yellow-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(u.Z,{className:"h-8 w-8 text-white"})}),(0,s.jsx)("div",{className:"text-2xl font-bold mb-2",children:"Premium Content"}),(0,s.jsx)("div",{className:"text-sm opacity-90 mb-4",children:"Upgrade to access all premium trading videos."}),(0,s.jsx)("span",{className:"btn btn-primary btn-sm",children:"Upgrade Now"})]})})})]}),R&&Z&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-black bg-opacity-50 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-grey-300",children:"Edit Premium Video"}),(0,s.jsx)("button",{onClick:ei,className:"text-gray-400 hover:text-gray-300",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-grey-300 mb-1",children:"Title"}),(0,s.jsx)("input",{type:"text",className:"input w-full",value:_,onChange:e=>A(e.target.value),placeholder:"Video title"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-grey-300 mb-1",children:"Description"}),(0,s.jsx)("textarea",{className:"input w-full",rows:3,value:V,onChange:e=>I(e.target.value),placeholder:"Short description about this video..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-grey-300 mb-1",children:"Category"}),(0,s.jsx)("select",{className:"input w-full",value:M,onChange:e=>T(e.target.value),children:K.slice(1).map(e=>(0,s.jsx)("option",{className:"bg-black bg-opacity-80",value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:er,className:"btn btn-primary flex-1",disabled:z,children:z?"Saving...":"Update Video"}),(0,s.jsx)("button",{onClick:ei,className:"btn btn-outline flex-1",children:"Cancel"})]})]})})})]})}},576:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(7437),l=a(1396),r=a.n(l),i=a(5375);function n(e){let{isAuthenticated:t,isPremiumUser:a=!1,className:l="",showIcon:n=!0,title:o,description:c,buttonText:d,buttonHref:u}=e;return(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center ".concat(l),children:(0,s.jsxs)("div",{className:"text-center text-white p-6",children:[n&&(0,s.jsx)("div",{className:"w-16 h-16 bg-yellow-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(i.Z,{className:"h-8 w-8 text-white"})}),(0,s.jsx)("h3",{className:"text-xl font-bold mb-2",children:o||(t?"Premium Content":"Login Required")}),(0,s.jsx)("p",{className:"text-sm mb-4 opacity-90",children:c||(t?"Upgrade to Premium to watch this video":"Please login to watch this video")}),(0,s.jsx)(r(),{href:u||(t?"/upgrade":"/login"),className:"btn btn-primary btn-sm",children:d||(t?"Upgrade Now":"Login")})]})})}},1122:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return n},useAuth:function(){return o}});var s=a(7437),l=a(2265),r=a(1097);let i=(0,l.createContext)(void 0);function n(e){let{children:t}=e,[a,n]=(0,l.useState)(null),[o,c]=(0,l.useState)(null),[d,u]=(0,l.useState)(!0),m=(0,r.e)();(0,l.useEffect)(()=>{let e=async e=>{try{let{data:t,error:a}=await m.from("profiles").select("*").eq("id",e).single();a?console.error("Error fetching profile:",a):c(t)}catch(e){console.error("Error in fetchProfile:",e)}};(async()=>{try{let{data:{session:t},error:a}=await m.auth.getSession();a?console.error("Error getting session:",a):(null==t?void 0:t.user)&&(n(t.user),await e(t.user.id))}catch(e){console.error("Error in getInitialSession:",e)}finally{u(!1)}})();let{data:{subscription:t}}=m.auth.onAuthStateChange(async(t,a)=>{"SIGNED_IN"===t&&(null==a?void 0:a.user)?(n(a.user),await e(a.user.id)):"SIGNED_OUT"===t&&(n(null),c(null)),u(!1)});return()=>{t.unsubscribe()}},[m.auth]);let h=async()=>{try{let{error:e}=await m.auth.signOut();e&&console.error("Error signing out:",e)}catch(e){console.error("Error in signOut:",e)}},g=async()=>{if(a)try{let{data:e,error:t}=await m.from("profiles").select("*").eq("id",a.id).single();t?console.error("Error refreshing profile:",t):c(e)}catch(e){console.error("Error in refreshProfile:",e)}};return(0,s.jsx)(i.Provider,{value:{user:a,profile:o,loading:d,signOut:h,refreshProfile:g},children:t})}function o(){let e=(0,l.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1097:function(e,t,a){"use strict";a.d(t,{e:function(){return l}});var s=a(3082);let l=()=>(0,s.createClientComponentClient)()},2169:function(e,t,a){"use strict";a.d(t,{p6:function(){return r}});var s=a(4493),l=a(6413);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM dd, yyyy";try{let a="string"==typeof e?(0,s.Z)(e):e;return(0,l.Z)(a,t)}catch(e){return console.error("Error formatting date:",e),"Invalid date"}}}},function(e){e.O(0,[872,82,250,482,971,938,744],function(){return e(e.s=3856)}),_N_E=e.O()}]);