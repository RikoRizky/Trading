"use strict";exports.id=2745,exports.ids=[2745],exports.modules={12745:(t,e,r)=>{r.d(e,{T:()=>a,verifyPayment:()=>u});let n={midtrans:{serverKey:process.env.MIDTRANS_SERVER_KEY,clientKey:process.env.MIDTRANS_CLIENT_KEY,isProduction:"production"===(process.env.MIDTRANS_ENV||"").toLowerCase()||"sandbox"!==(process.env.MIDTRANS_ENV||"").toLowerCase()},xendit:{secretKey:process.env.XENDIT_SECRET_KEY,publicKey:process.env.XENDIT_PUBLIC_KEY,callbackToken:process.env.XENDIT_CALLBACK_TOKEN},dana:{merchantId:process.env.DANA_MERCHANT_ID,secretKey:process.env.DANA_SECRET_KEY}};async function a(t,e,r,n="custom"){switch(n){case"midtrans":return s(t,e,r);case"xendit":return o(t,e,r);case"dana":return c(t,e,r);default:return i(t,e,r)}}async function i(t,e,n){let a={paymentId:t,amount:e,description:n,timestamp:Date.now(),merchantName:"Trading Platform"};try{let t=r(77670);return await t.toDataURL(JSON.stringify(a),{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(r){return console.error("QR Code generation failed:",r),d(t,e)}}async function s(t,e,r){let{serverKey:a,isProduction:i}=n.midtrans;if(!a)throw Error("Midtrans server key not configured");try{let n=await fetch("https://api.midtrans.com/v2/qris",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${Buffer.from(a+":").toString("base64")}`},body:JSON.stringify({transaction_details:{order_id:t,gross_amount:e},item_details:[{id:"premium-subscription",price:e,quantity:1,name:r}],qris:{acquirer:"gopay"}})}),i=await n.json();if("201"===i.status_code)return i.qr_string;throw Error(`Midtrans error: ${i.status_message}`)}catch(r){return console.error("Midtrans QRIS generation failed:",r),d(t,e)}}async function o(t,e,r){let{secretKey:a}=n.xendit;if(!a)throw Error("Xendit secret key not configured");try{let n=await fetch("https://api.xendit.co/qr_codes",{method:"POST",headers:{Authorization:`Basic ${Buffer.from(a+":").toString("base64")}`,"Content-Type":"application/json"},body:JSON.stringify({reference_id:t,type:"DYNAMIC",currency:"IDR",amount:e,description:r})}),i=await n.json();if(i.id)return i.qr_string;throw Error(`Xendit error: ${i.message}`)}catch(r){return console.error("Xendit QRIS generation failed:",r),d(t,e)}}async function c(t,e,r){let{merchantId:a,secretKey:i}=n.dana;if(!a||!i)throw Error("DANA credentials not configured");return d(t,e)}function d(t,e){return`data:image/svg+xml;base64,${Buffer.from(`
    <svg width="256" height="256" xmlns="http://www.w3.org/2000/svg">
      <rect width="256" height="256" fill="white"/>
      <text x="128" y="128" text-anchor="middle" font-family="monospace" font-size="12">
        QRIS Payment
        ${t}
        Rp ${e.toLocaleString()}
      </text>
    </svg>
  `).toString("base64")}`}async function u(t,e="midtrans"){switch(e){case"midtrans":return f(t);case"xendit":return p(t);case"dana":return l(t);default:return m(t)}}async function f(t){let{serverKey:e,isProduction:r}=n.midtrans;try{let n=await fetch(`${r?"https://api.midtrans.com":"https://api.sandbox.midtrans.com"}/v2/${t}/status`,{headers:{Authorization:`Basic ${Buffer.from(e+":").toString("base64")}`}}),a=await n.json();if("settlement"===a.transaction_status||"capture"===a.transaction_status)return{status:"paid",transactionId:String(a.transaction_id||"")};if("pending"===a.transaction_status)return{status:"pending"};return{status:"failed"}}catch(t){return console.error("Midtrans verification failed:",t),{status:"failed"}}}async function p(t){let{secretKey:e}=n.xendit;try{let r=await fetch(`https://api.xendit.co/qr_codes/${t}`,{headers:{Authorization:`Basic ${Buffer.from(e+":").toString("base64")}`}}),n=await r.json();if("COMPLETED"===n.status)return{status:"paid",transactionId:String(n.id||"")};if("PENDING"===n.status)return{status:"pending"};return{status:"failed"}}catch(t){return console.error("Xendit verification failed:",t),{status:"failed"}}}async function l(t){return m(t)}async function m(t){return Math.random()>.7?{status:"paid",transactionId:`TXN_${Date.now()}`}:{status:"pending"}}}};